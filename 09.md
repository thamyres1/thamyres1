
/**
Lista de exercícios - JOIN 
Responda as questões:
01 - O que é JOIN? Quando é necessário?
 JOIN  é  utilizado para consultas de mais de uma tabela.

04 - O que é primordial para que o resultado tenha sentido em consultas com JOIN? Explique.
A condição de junção, a comparação do identificador de uma tabela e a sua referência na tabela que será juntada.
Sem a condição de junção, todos os registros serão combinados, gerando um resultado com a semântica indesejada.


05 - Existe mais de uma maneira de realizar o JOIN? Quantas? Qual é a mais eficiente? 
Sim, duas, o padrão SQL89 e o SQL92. Não há diferença em funcionamento .


06 - Para realizar o JOIN de 1523 tabelas, quantas comparações de junções são necessárias? Explique.
Serão necessárias 1522 comparações de junções. Para cada duas tabelas é necessário uma comparação de junção.

/*

-- 01 
-- SQL 89
SELECT *
FROM estado,cidade;

-- SQL 92
SELECT * 
FROM estado 
JOIN cidade ON estado.id = estado_id;

-- 02 
-- SQL 89
SELECT cidade.nome 'NOME DA CIDADE'
    ,cidade.id 'CÓDIGO DA CIDADE'
    ,cidade.sigla 'SIGLA DA CIDADE'
FROM estado,cidade
WHERE cidade.estado_id = estado.id;

-- SQL 92
SELECT cidade.nome 'NOME DA CIDADE'
    ,cidade.id 'CÓDIGO DA CIDADE'
    ,cidade.sigla 'SIGLA DA CIDADE'
FROM estado 
INNER JOIN cidade ON  cidade.estado_id = estado.id;


-- 03
-- SQL 89
SELECT 
    cidade.nome 
    ,cidade.id 
    ,cidade.estado_id  
    ,cidade.data_cadastro  
    ,estado.id  
    ,estado.nome  
    ,estado.sigla 
    ,estado.data_cadastro   
FROM estado,cidade
WHERE estado.id = cidade.estado.id;

-- SQL 92
SELECT 
	 cidade.nome 
    ,cidade.id 
    ,cidade.estado_id  
    ,cidade.data_cadastro  
    ,estado.id  
    ,estado.nome  
    ,estado.sigla 
    ,estado.data_cadastro   
FROM estado 
JOIN cidade ON estado.id = cidade.estado.id;



-- 04
-- SQL 89
SELECT 
    cidade.nome 'MUNICÍPIO'
    ,cidade.id  'CODIGO'
    ,cidade.estado_id  'ESTADO'
    ,cidade.data_cadastro  'ANO QUE FUNDOU'
    ,estado.id  'CODIGO'
    ,estado.nome  'ESTADO'
    ,estado.sigla  'SIGLA'
    ,estado.data_cadastro   'CADASTRO DO ESTADO'
FROM estado,cidade
WHERE cidade.estado_id = estado.id;

-- SQL 92
SELECT 
	estado.id  'CODIGO'
    ,estado.nome  'ESTADO'
    ,estado.sigla  'SIGLA'
    ,estado.data_cadastro   'DATA DO ESTADO'
	,cidade.nome 'MUNICÍPIO'
    ,cidade.id  'CODIGO'
    ,cidade.estado_id  'ESTADO'
    ,cidade.data_cadastro  'ANO QUE FUNDOU'
FROM estado 
JOIN cidade ON  cidade.estado_id = estado.id;

-- 05
/*
Para  mim não ouve diferença , era o mesmo exercicios , so a escrita da questão, inclusive eu nem entedi a questão3
*/
-- 06
-- ' Os registros  gerados no resultado do exercício 02 foram :1.000'
-- ' Sim comando do exercício anterior pode ser utilizado para descobrir as cidades da região sul, basta colocar o WHERE e o AND , e definir os comandos'


-- 07 
-- SQL 89
SELECT 
    estado.sigla  
	,cidade.nome 
    ,cidade.id  
FROM estado,cidade
WHERE  estado.nome = 'SÃO PAULO'  ;

-- SQL 92
SELECT 
    estado.sigla  
	,cidade.nome 
    ,cidade.id  
FROM estado
JOIN cidade ON  cidade.estado_id = estado.id
  AND estado.nome = 'SÃO PAULO';


-- SQL89
SELECT 
	c.id 'código cidade'
	, c.nome 'nome cidade'
	, e.sigla 'sigla estado'
FROM cidade c, estado e
WHERE e.id = c.estado_id
	AND e.nome IN('MINAS GERAIS','ESPÍRITO SANTO','RIO DE JANEIRO','SÃO PAULO');

-- SQL92
SELECT 
	c.id 'código cidade'
	, c.nome 'nome cidade'
	, e.sigla 'sigla estado'
FROM estado e
INNER JOIN cidade c ON e.id = c.estado_id
WHERE e.nome IN('MINAS GERAIS','ESPÍRITO SANTO','RIO DE JANEIRO','SÃO PAULO');


-- 09
-- SQL89
SELECT 
	f.nome
FROM funcionario f, cidade c, estado e
WHERE e.id = c.estado_id
	AND c.id = f.cidade_id
	AND e.nome = 'PARANÁ';

-- SQL92
SELECT 
	f.nome
FROM estado e
INNER JOIN cidade c ON e.id = c.estado_id 
INNER JOIN funcionario f ON c.id = f.cidade_id
WHERE e.nome = 'PARANÁ';

-- 10 
-- SQL89
SELECT 
	f.nome, f.fone, f.fone_segundario
FROM fornecedor f, cidade c
WHERE 
	c.id = f.cidade_id
	AND c.nome = 'SÃO PAULO'; //CUIDADO A CIDADE NÃO É ÚNICA

-- SQL92
SELECT 
	f.nome, f.fone, f.fone_segundario 
FROM cidade c 
INNER JOIN fornecedor f ON c.id = f.cidade_id
WHERE c.nome = 'SÃO PAULO';


-- 11

-- SQL89
SELECT 
	p.nome
FROM 
	produto p
	, produto_categoria pc 
	, categoria c
	, linha_categoria lc 
	, linha l
WHERE 
	p.id = pc.produto_id
	AND pc.categoria_id = c.id
	AND c.id = lc.categoria_id
	AND lc.linha_id = l.id
	AND c.nome = 'BEBEIDA NÃO ALCÓOLICA'
	AND l.nome = 'ALIMENTOS E BEBIDAS'; 

